<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kdub Productions</title>
    <link rel="stylesheet" type="text/css" href="mainstyle.css">
</head>
<body>
    <div id="maindiv">
        <!-- Header Section -->
        <div class="heading_1_div">
            <h2 class="heading_1">Kdub Productions</h2>
            <p class="artist-header">Artists</p>
        </div>

        <!-- Search Bar -->
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="Search videos or mixtapes..." onkeyup="filterContent()">
        </div>

        <!-- Navigation Tab -->
        <div class="nav-tabs">
            <button class="tab-button" onclick="showTab('videos')">Videos</button>
            <button class="tab-button" onclick="showTab('mixtapes')">Mixtapes</button>
        </div>

        <!-- Content Section -->
        <div class="songs_div">
            <div class="grid-container" id="video-grid"></div>
        </div>

        <!-- Pagination -->
        <div class="pagination">
            <button id="prev-btn" onclick="previousPage()">Previous</button>
            <button id="next-btn" onclick="nextPage()">Next</button>
        </div>
    </div>

    <script>
        const apiKey = "AIzaSyBWXAiWVwtsv3lrMKC3eXSQs7UqjSVWLt8"; // Replace with your YouTube API key
        const channelId = "UCxLInTOesiaJPHRcr-q56aQ"; // Replace with your YouTube channel ID
        const playlistId = "YOUR_PLAYLIST_ID"; // Replace with your playlist ID for mixtapes
        const videosPerPage = 12;
        let videos = [];
        let mixtapes = [];
        let nextPageToken = "";
        let prevPageToken = "";
        
        // Fetch videos and mixtapes
        async function fetchVideos(pageToken = "") {
            const url = `https://www.googleapis.com/youtube/v3/search?key=${apiKey}&channelId=${channelId}&part=snippet&type=video&maxResults=${videosPerPage}&pageToken=${pageToken}`;

            try {
                const response = await fetch(url);
                const data = await response.json();

                // Check for API errors
                if (data.error) {
                    console.error("API Error:", data.error.message);
                    alert("An error occurred: " + data.error.message);
                    return;
                }

                // Extract video data
                videos = data.items.map((item) => ({
                    src: `https://www.youtube.com/embed/${item.id.videoId}`,
                    title: item.snippet.title,
                }));
                nextPageToken = data.nextPageToken || null;
                prevPageToken = data.prevPageToken || null;

                showPage();
            } catch (error) {
                console.error("Fetch Error:", error);
                alert("Failed to fetch videos. Check the console for details.");
            }
        }

        // Fetch mixtapes (YouTube playlist items)
        async function fetchMixtapes(pageToken = "") {
            const url = `https://www.googleapis.com/youtube/v3/playlistItems?key=${apiKey}&playlistId=${playlistId}&part=snippet&maxResults=${videosPerPage}&pageToken=${pageToken}`;

            try {
                const response = await fetch(url);
                const data = await response.json();

                // Check for API errors
                if (data.error) {
                    console.error("API Error:", data.error.message);
                    alert("An error occurred: " + data.error.message);
                    return;
                }

                // Extract mixtape data
                mixtapes = data.items.map((item) => ({
                    src: `https://www.youtube.com/embed/${item.snippet.resourceId.videoId}`,
                    title: item.snippet.title,
                }));
                nextPageToken = data.nextPageToken || null;
                prevPageToken = data.prevPageToken || null;

                showPage();
            } catch (error) {
                console.error("Fetch Error:", error);
                alert("Failed to fetch mixtapes. Check the console for details.");
            }
        }

        // Display videos or mixtapes
        function showPage() {
            const videoGrid = document.getElementById("video-grid");
            videoGrid.innerHTML = ""; // Clear current content

            const content = (currentTab === "videos" ? videos : mixtapes);

            content.forEach((item) => {
                const gridItem = document.createElement("div");
                gridItem.classList.add("grid-item");

                const iframe = document.createElement("iframe");
                iframe.src = item.src;
                iframe.allowFullscreen = true;

                const description = document.createElement("p");
                description.innerHTML = `<strong>Title:</strong> ${item.title}`;

                gridItem.appendChild(iframe);
                gridItem.appendChild(description);
                videoGrid.appendChild(gridItem);
            });

            updateButtonStates();
        }

        // Switch between videos and mixtapes tabs
        let currentTab = "videos"; // Default to videos
        function showTab(tabName) {
            currentTab = tabName;
            if (tabName === "videos") {
                fetchVideos();
            } else if (tabName === "mixtapes") {
                fetchMixtapes();
            }
        }

        // Handle pagination
        function nextPage() {
            if (nextPageToken) {
                if (currentTab === "videos") fetchVideos(nextPageToken);
                else fetchMixtapes(nextPageToken);
            }
        }

        function previousPage() {
            if (prevPageToken) {
                if (currentTab === "videos") fetchVideos(prevPageToken);
                else fetchMixtapes(prevPageToken);
            }
        }

        // Update pagination buttons
        function updateButtonStates() {
            document.getElementById("prev-btn").style.display = prevPageToken ? "inline-block" : "none";
            document.getElementById("next-btn").style.display = nextPageToken ? "inline-block" : "none";
        }

        // Search filter for videos and mixtapes
        function filterContent() {
            const query = document.getElementById("search-input").value.toLowerCase();
            const content = (currentTab === "videos" ? videos : mixtapes);
            const filteredContent = content.filter(item => item.title.toLowerCase().includes(query));
            displayFilteredContent(filteredContent);
        }

        // Display the filtered content
        function displayFilteredContent(filteredContent) {
            const videoGrid = document.getElementById("video-grid");
            videoGrid.innerHTML = ""; // Clear current content

            filteredContent.forEach((item) => {
                const gridItem = document.createElement("div");
                gridItem.classList.add("grid-item");

                const iframe = document.createElement("iframe");
                iframe.src = item.src;
                iframe.allowFullscreen = true;

                const description = document.createElement("p");
                description.innerHTML = `<strong>Title:</strong> ${item.title}`;

                gridItem.appendChild(iframe);
                gridItem.appendChild(description);
                videoGrid.appendChild(gridItem);
            });
        }

        // Initial fetch
        fetchVideos();
    </script>
</body>
</html>
