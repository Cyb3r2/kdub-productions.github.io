<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Grid with Lazy Loading</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="grid-container" id="video-grid"></div>

    <div class="pagination">
        <button id="prev-btn" onclick="previousPage()">Previous</button>
        <button id="next-btn" onclick="nextPage()">Next</button>
    </div>

    <script>
        const apiKey = 'AIzaSyBWXAiWVwtsv3lrMKC3eXSQs7UqjSVWLt8';
        const channelId = 'UCxLInTOesiaJPHRcr-q56aQ';
        const videosPerPage = 12;
        let nextPageToken = '';
        let prevPageToken = '';
        let videos = [];

        async function fetchVideos(pageToken = '') {
            const url = `https://www.googleapis.com/youtube/v3/search?key=${apiKey}&channelId=${channelId}&part=snippet&type=video&maxResults=${videosPerPage}&pageToken=${pageToken}`;

            try {
                const response = await fetch(url);
                const data = await response.json();

                if (data.error) {
                    console.error("API Error:", data.error.message);
                    alert("An error occurred: " + data.error.message);
                    return;
                }

                videos = data.items.map(item => ({
                    src: `https://www.youtube.com/embed/${item.id.videoId}`,
                    title: item.snippet.title,
                    thumbnail: item.snippet.thumbnails.medium.url,
                }));

                nextPageToken = data.nextPageToken || null;
                prevPageToken = data.prevPageToken || null;

                showPage();
            } catch (error) {
                console.error("Fetch Error:", error);
                alert("Failed to fetch videos. Check the console for details.");
            }
        }

        function showPage() {
            const videoGrid = document.getElementById("video-grid");
            videoGrid.innerHTML = "";

            videos.forEach((video) => {
                const gridItem = document.createElement("div");
                gridItem.classList.add("grid-item");

                const iframe = document.createElement("iframe");
                iframe.src = video.src;
                iframe.allowFullscreen = true;
                iframe.loading = 'lazy';

                const thumbnail = document.createElement("img");
                thumbnail.src = video.thumbnail;
                thumbnail.alt = video.title;
                thumbnail.loading = 'lazy';

                const description = document.createElement("p");
                description.innerHTML = `<strong>Title:</strong> ${video.title}`;

                gridItem.appendChild(thumbnail);
                gridItem.appendChild(description);
                videoGrid.appendChild(gridItem);
            });

            updateButtonStates();
        }

        function nextPage() {
            if (nextPageToken) {
                fetchVideos(nextPageToken);
            }
        }

        function previousPage() {
            if (prevPageToken) {
                fetchVideos(prevPageToken);
            }
        }

        function updateButtonStates() {
            document.getElementById("prev-btn").style.display = prevPageToken ? "inline-block" : "none";
            document.getElementById("next-btn").style.display = nextPageToken ? "inline-block" : "none";
        }

        fetchVideos();
    </script>
</body>
</html>
